@import "tailwindcss";

:root {
  --background: oklch(0.98 0.01 95.1);
  --foreground: oklch(0.34 0.03 95.72);
  --card: oklch(0.98 0.01 95.1);
  --card-foreground: oklch(0.19 0 106.59);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.27 0.02 98.94);
  --primary: oklch(0.62 0.14 39.04);
  --primary-foreground: oklch(1 0 0);
  --secondary: oklch(0.92 0.01 92.99);
  --secondary-foreground: oklch(0.43 0.02 98.6);
  --muted: oklch(0.93 0.02 90.24);
  --muted-foreground: oklch(0.61 0.01 97.42);
  --accent: oklch(0.92 0.01 92.99);
  --accent-foreground: oklch(0.27 0.02 98.94);
  --destructive: oklch(0.19 0 106.59);
  --border: oklch(0.88 0.01 97.36);
  --input: oklch(0.76 0.02 98.35);
  --ring: oklch(0.59 0.17 253.06);
  --sidebar: oklch(0.97 0.01 98.88);
  --sidebar-foreground: oklch(0.36 0.01 106.65);
  --sidebar-primary: oklch(0.62 0.14 39.04);
  --sidebar-primary-foreground: oklch(0.99 0 0);
  --sidebar-accent: oklch(0.92 0.01 92.99);
  --sidebar-accent-foreground: oklch(0.33 0 0);
  --sidebar-border: oklch(0.94 0 0);
  --sidebar-ring: oklch(0.77 0 0);
  
  --chat-out: oklch(91.619% 0.0445 38.665);
  --chat-in: oklch(1 0 0);
}

.dark {
  --background: oklch(0.27 0 106.64);
  --foreground: oklch(0.81 0.01 93.01);
  --card: oklch(0.27 0 106.64);
  --card-foreground: oklch(0.98 0.01 95.1);
  --popover: oklch(0.31 0 106.6);
  --popover-foreground: oklch(0.92 0 106.48);
  --primary: oklch(0.67 0.13 38.76);
  --primary-foreground: oklch(1 0 0);
  --secondary: oklch(0.98 0.01 95.1);
  --secondary-foreground: oklch(0.31 0 106.6);
  --muted: oklch(0.22 0 106.71);
  --muted-foreground: oklch(0.77 0.02 99.07);
  --accent: oklch(0.21 0.01 95.42);
  --accent-foreground: oklch(0.97 0.01 98.88);
  --destructive: oklch(0.64 0.21 25.33);
  --border: oklch(0.36 0.01 106.89);
  --input: oklch(0.43 0.01 100.22);
  --ring: oklch(0.59 0.17 253.06);
  --sidebar: oklch(0.24 0.00 67.71); 
  --sidebar-foreground: oklch(0.81 0.01 93.01);
  --sidebar-primary: oklch(0.33 0 0);
  --sidebar-primary-foreground: oklch(0.99 0 0);
  --sidebar-accent: oklch(0.17 0 106.62);
  --sidebar-accent-foreground: oklch(0.81 0.01 93.01);
  --sidebar-border: oklch(0.94 0 0);
  --sidebar-ring: oklch(0.77 0 0);

  --chat-out: oklch(43.696% 0.08141 40.805);
  --chat-in: oklch(0.31 0 106.6);
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  --color-incoming-chat-bubble: var(--chat-in);
  --color-outgoing-chat-bubble: var(--chat-out);
}

html,
body {
  padding: 0;
  margin: 0;
  font-family:
    Segoe UI,
    Helvetica Neue,
    Helvetica,
    Lucida Grande,
    Arial,
    Ubuntu,
    Cantarell,
    Fira Sans,
    sans-serif;
}

a {
  color: inherit;
  text-decoration: none;
}

button {
  cursor: pointer;
}

button:disabled {
  cursor: default;
}

@layer components {
  .label {
    @apply text-[12px] text-muted-foreground mb-[8px];
  }

  form {
    @apply flex flex-col gap-[24px] grow pl-[10px];
  }

  /* Override form styles for login page */
  .login-form {
    @apply grow-0 gap-3 pl-0;
  }

  .section-body p {
    @apply text-muted-foreground text-[14px] leading-relaxed;
  }

  textarea {
    field-sizing: content;
    resize: none;
  }

  input.text {
    @apply w-full border-b-[2px] border-transparent hover:border-input pb-[2px] focus-visible:outline-none text-[16px] text-foreground placeholder:text-muted-foreground bg-transparent focus-visible:border-primary;
  }
  
  textarea.text {
    @apply w-full focus-visible:outline-none text-[16px] text-foreground placeholder:text-muted-foreground bg-transparent focus-visible:border-primary;
  }

  select {
    @apply w-full pb-[2px] border-b-[2px] border-transparent hover:border-input focus-visible:outline-none text-[16px] text-foreground placeholder:text-muted-foreground bg-transparent focus-visible:border-primary;
  }

  button.primary {
    @apply bg-primary hover:bg-primary/90 disabled:opacity-50 text-primary-foreground rounded-full text-[16px] py-[8px];
  }

  button.destructive {
    @apply bg-transparent border border-destructive hover:bg-destructive/10 text-destructive rounded-full text-[16px] py-[8px];
  }

  .header {
    @apply h-[60px] py-[10px] px-[20px] flex shrink-0;
  }

  .spin {
    @apply animate-spin [transform-box:fill-box] [transform-origin:center] stroke-current fill-none;
  }

  .bg-chat {
    background-color: var(--color-muted);
    z-index: 0;
  }

  .bg-chat::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url("/bg-chat-tile-dark.png");
    background-repeat: repeat;
    opacity: 0.06; /* Subtle pattern for light mode */
    filter: invert(1); /* Invert to make dark pattern on light background if original is light-on-dark */
    z-index: -1;
    pointer-events: none;
  }

  .dark .bg-chat::before {
    opacity: 0.12;
    filter: none; /* Keep original for dark mode */
  }

  /* WhatsApp Web-like Grid Layout */
  .app-grid {
    display: grid;
    /* Default (lg+): Menu | Left Panel | Chat */
    grid-template-columns: 48px minmax(300px, 1fr) 2fr;
    height: 100dvh;
    width: 100vw;
    overflow: hidden;
  }

  @media (min-width: 1024px) {
    .app-grid {
      grid-template-columns: 64px minmax(300px, 1fr) 2fr;
    }
  }

  /* Resize Handle for panels */
  .resize-handle {
    position: absolute;
    top: 0;
    right: 0;
    width: 4px;
    height: 100%;
    cursor: col-resize;
    background: transparent;
    transition: background-color 0.15s ease;
    z-index: 10;
  }

  .resize-handle:hover,
  .resize-handle:active {
    background-color: var(--color-primary);
  }

  /* Hide scrollbar but keep scroll functionality */
  .scrollbar-hide {
    -ms-overflow-style: none !important;
    scrollbar-width: none !important;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none !important;
  }

  /* Responsive breakpoints */
  
  /* 
   Tailwind CSS v4 default breakpoints:

   - sm: 640px
   - md: 768px
   - lg: 1024px
   - xl: 1280px
   - 2xl: 1536px

   Responsive Strategy:
  
   - xl+: 3 columns. Menu (64px) | Left Panel (max 400px) | Chat (1fr).
   - xl-lg: 3 columns. Left Panel grows (35%).
   - lg-md: 3 columns. Left Panel (min 300px).
   - md-: Mobile, 2 views:
     1. Menu (64px) | Left panel (1fr).
     2. Chat (1fr).
     
     Content toggles between views based on active conversation.
     Controlled by Tailwind classes in _auth.tsx (hidden/flex).
  */
}

input[type="range"] {
  -webkit-appearance: none;
  background-color: transparent;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  box-sizing: content-box;
  height: 12px;
  width: 12px;
  border: none;
}

input[type="range"]::-moz-range-thumb {
  height: 12px;
  width: 12px;
  border: none;
}

input[type="range"]::-webkit-slider-runnable-track {
  appearance: none;
}

input[type="range"]::-moz-range-track {
  appearance: none;
}

/* Firefox */
* {
  scrollbar-width: thin;
  scrollbar-color: #ced0d1 transparent;
}

/* WebKit */
*::-webkit-scrollbar {
  width: 0.3rem;
  height: 0.3rem;
}

*::-webkit-scrollbar-track {
  background: transparent;
}

*::-webkit-scrollbar-thumb {
  background-color: #ced0d1;
  border-radius: 0.6rem;
  border: none;
}

/* Text messages */
.markdown p + p,
.markdown p + ul,
.markdown p + ol,
.markdown ul + p,
.markdown ul + ul,
.markdown ul + ol,
.markdown ol + p,
.markdown ol + ul,
.markdown ol + ol {
  margin-top: 1rem;
}

.markdown li,
.markdown li ul,
.markdown li ol {
  margin-left: 1.4rem; /* Adjust margin for nested lists */
}

.markdown ol li {
  list-style-type: decimal;
}

.markdown ul li {
  list-style-type: disc;
}

.markdown code,
pre {
  text-wrap: wrap;
}

.templateField {
  text-decoration: underline;
  text-decoration-color: #53bdeb;
  text-decoration-thickness: 2px;
  background-color: #53bdeb2d;
}

.template-form {
  input,
  select,
  textarea,
  button {
    padding: 6px 12px;
    border-radius: 7.5px;
  }
  .field {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
}